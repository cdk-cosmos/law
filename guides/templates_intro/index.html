<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<title data-react-helmet="true">Building a template - Intro | Cdk Cosmos Law</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Building a template - Intro | Cdk Cosmos Law"><meta data-react-helmet="true" name="description" content="This section will follow the steps taken to build out a new template in Cosmos. Templates are a good way to start with a predefined set of resources used to deploy common patterns in Cosmos. This section will show you how to build out two different templates, in order to provide a greater understanding of where to put different resources and why. From this starting point, you will be able to build out templates that meet your own specific needs."><meta data-react-helmet="true" property="og:description" content="This section will follow the steps taken to build out a new template in Cosmos. Templates are a good way to start with a predefined set of resources used to deploy common patterns in Cosmos. This section will show you how to build out two different templates, in order to provide a greater understanding of where to put different resources and why. From this starting point, you will be able to build out templates that meet your own specific needs."><meta data-react-helmet="true" property="og:url" content="https://cdk-cosmos.github.io//law/guides/templates_intro"><link data-react-helmet="true" rel="shortcut icon" href="/law/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://cdk-cosmos.github.io//law/guides/templates_intro"><link rel="stylesheet" href="/law/styles.6eaf09fd.css">
<link rel="preload" href="/law/styles.e4c59df8.js" as="script">
<link rel="preload" href="/law/runtime~main.86f6e787.js" as="script">
<link rel="preload" href="/law/main.3bdcd07c.js" as="script">
<link rel="preload" href="/law/1.8571fb6d.js" as="script">
<link rel="preload" href="/law/2.2961cee2.js" as="script">
<link rel="preload" href="/law/236.315ef293.js" as="script">
<link rel="preload" href="/law/237.a932438a.js" as="script">
<link rel="preload" href="/law/284db4bf.4c9bf30e.js" as="script">
<link rel="preload" href="/law/17896441.15f9fc3d.js" as="script">
<link rel="preload" href="/law/a0acecc6.45326a14.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/law/"><img class="navbar__logo" src="/law/img/cdk-cosmos-crop.png" alt="Cdk Cosmos"><strong class="navbar__title">Cdk Cosmos</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/law/guides/">Guides</a><a class="navbar__item navbar__link" href="/law/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/cdk-cosmos" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/law/"><img class="navbar__logo" src="/law/img/cdk-cosmos-crop.png" alt="Cdk Cosmos"><strong class="navbar__title">Cdk Cosmos</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/law/guides/">Guides</a></li><li class="menu__list-item"><a class="menu__link" href="/law/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/cdk-cosmos" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/law/guides/">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/law/guides/getting_started_bootstrap">Bootstrapper</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/law/guides/getting_started_core">Core</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/law/guides/getting_started_extension">Extensions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/law/guides/getting_started_app">Hello World App</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Template Building</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/law/guides/templates_intro">Building Your Own Templates</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/law/guides/templates_ecr">ECR Template</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/law/guides/templates_lambda">Lambda Template</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Building a template - Intro</h1></header><div class="markdown"><p>This section will follow the steps taken to build out a new template in Cosmos. Templates are a good way to start with a predefined set of resources used to deploy common patterns in Cosmos. This section will show you how to build out two different templates, in order to provide a greater understanding of where to put different resources and why. From this starting point, you will be able to build out templates that meet your own specific needs.</p><p>The base template we&#x27;ll be using is the blank app template:
<a href="https://github.com/cdk-cosmos/cosmos-blank-extension-cdk" target="_blank" rel="noopener noreferrer">Cosmos Blank App CDK Template</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="template-sections"></a>Template Sections<a aria-hidden="true" tabindex="-1" class="hash-link" href="#template-sections" title="Direct link to heading">#</a></h3><p>An app CDK template requires a few main sections:</p><ul><li>bin folder, containing a main.ts file</li><li>lib folder, containing files described below. The resources defined in the lib folder are created when the bootstrapper runs and updated via the cdk pipeline.</li></ul><p>The blank extension template also includes a few extras such as the Prettier formatter and Jest tests</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="libci-cd-solar-systemts"></a>lib/ci-cd-solar-system.ts<a aria-hidden="true" tabindex="-1" class="hash-link" href="#libci-cd-solar-systemts" title="Direct link to heading">#</a></h4><p>This is where you will define the CiCd infrastructure for your extension. This includes:</p><ul><li>Defining the functionality to add stages to the CDK and Code pipelines for your extension</li><li>Selecting the appropriate type of pipeline for the resources you are deploying</li></ul><p>There is only one instance of the cicd solar system, which is located in the management account and used to deploy into other environments.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="libcosmosts"></a>lib/cosmos.ts<a aria-hidden="true" tabindex="-1" class="hash-link" href="#libcosmosts" title="Direct link to heading">#</a></h4><p>This file defines resources that exist at the Cosmos level (in the management account), such as:</p><ul><li>CodeCommit code repo </li><li>s3 code bucket if using lambda</li><li>ecr repo if using containers</li></ul><p>Your CDK repo is also created as part of this stack. This happens at the Cosmos level because the code for your extension is by default stored in CodeCommit of the management account, so that it can be deployed from there into each environment. Your cdk repo sits outside the App*MgtCiCdSolarSystem, because it defines the stack.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="libgalaxyts"></a>lib/galaxy.ts<a aria-hidden="true" tabindex="-1" class="hash-link" href="#libgalaxyts" title="Direct link to heading">#</a></h4><p>For this walkthrough, we will not be editing this file. You may need to add resources here for specific use cases, for example if you want to create a resource to share between multiple solar systems in the same galaxy, e.g. shared database</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="libindexts"></a>lib/index.ts<a aria-hidden="true" tabindex="-1" class="hash-link" href="#libindexts" title="Direct link to heading">#</a></h4><p>This is simply an index file, managing the exports from the lib folder so they can be used in <code>bin/main.ts</code>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="libsolar-systemts"></a>lib/solar-system.ts<a aria-hidden="true" tabindex="-1" class="hash-link" href="#libsolar-systemts" title="Direct link to heading">#</a></h4><p>This is where you define what resources are needed in each environment for your extension, such as DynamoDB tables, s3 buckets, Route 53 records etc. You define the resources once in this file, and Cosmos will deploy the resources to each environment you have defined in bin/main.ts when you run the extension cdk pipeline.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="binmaints"></a>bin/main.ts<a aria-hidden="true" tabindex="-1" class="hash-link" href="#binmaints" title="Direct link to heading">#</a></h4><p>This file describes your account configuration and instantiates the resources defined in the lib folder. For example, in the <code>lib/solar-system.ts</code> file you define the resources that should be created in each solar system in order to run your app. In <code>bin/main.ts</code> you instantiate a solar system into each environment (dev, prd etc).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="next-steps"></a>Next Steps:<a aria-hidden="true" tabindex="-1" class="hash-link" href="#next-steps" title="Direct link to heading">#</a></h2><ul><li><a href="/law/guides/templates_ecr">Building an ECR Template</a></li><li><a href="/law/guides/templates_lambda">Building a Lambda Template</a></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/cdk-cosmos/law/edit/master/guides/templates_intro.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/law/guides/getting_started_app"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Getting Started - Hello World App</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/law/guides/templates_ecr"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Building an ECR template Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#template-sections" class="table-of-contents__link">Template Sections</a></li><li><a href="#next-steps" class="table-of-contents__link">Next Steps:</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright Â© 2021 cdk-cosmos. Built with Docusaurus.</div></div></div></footer></div>
<script src="/law/styles.e4c59df8.js"></script>
<script src="/law/runtime~main.86f6e787.js"></script>
<script src="/law/main.3bdcd07c.js"></script>
<script src="/law/1.8571fb6d.js"></script>
<script src="/law/2.2961cee2.js"></script>
<script src="/law/236.315ef293.js"></script>
<script src="/law/237.a932438a.js"></script>
<script src="/law/284db4bf.4c9bf30e.js"></script>
<script src="/law/17896441.15f9fc3d.js"></script>
<script src="/law/a0acecc6.45326a14.js"></script>
</body>
</html>